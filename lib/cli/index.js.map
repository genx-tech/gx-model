{"version":3,"file":"index.js","names":["Starters","startCommand","require","_","findKey","pkg","AppInitiator","Commands","getCommandOptions","binItem","bin","v","afterCommandConfirmed","cli","cmd","argv","options","usage","parse","onVerboseMode","app","logger","level","resetLogger","main","commandLine","option","showUsage","console","log","version","command","appInitiator","cwd","process","run","commandName","config","banner","program","arguments","name","required","inquire","promptType","promptMessage","choicesProvider","map","desc","value","afterInquire","onArgumentExists","s","alias","bool","default","verbose","h","c","allow","type","fp","mp","silentMode","nonValidationMode","showUsageOnError","showArguments","module","parent","exports"],"sources":["../../src/cli/index.js"],"sourcesContent":["const {\n    Starters: { startCommand },\n} = require(\"@genx/app\");\nconst { _, findKey } = require(\"@genx/july\");\nconst pkg = require(\"../../package.json\");\n\nconst AppInitiator = require(\"../AppInitiator\");\nconst { Commands, getCommandOptions } = require(\"./commands\");\n\nconst binItem = findKey(pkg.bin, (v) => v === \"bin/geml.js\");\n\nconst afterCommandConfirmed = (cli) => {\n    let cmd = cli.argv._[0];\n    let options = getCommandOptions(cli, cmd);\n    cli.usage.options = { ...cli.usage.options, ...options };\n    cli.parse(cli.usage.options);\n};\n\nconst onVerboseMode = (cli) => {\n    if (cli.argv['verbose']) {\n        cli.app.options.logger.level = 'verbose';\n        cli.app.resetLogger();        \n    }\n};\n\nfunction main() {\n    startCommand(\n        (app) => {\n            let cmd = app.commandLine;\n\n            if (cmd.option(\"help\")) {\n                cmd.showUsage();\n                return;\n            }\n\n            if (cmd.option(\"version\")) {\n                console.log(pkg.version);\n                return;\n            }\n\n            let command = cmd.argv._[0];\n\n            const appInitiator = new AppInitiator({\n                app,\n                cwd: process.cwd(),\n            });\n\n            return appInitiator.run(command);\n        },\n        {\n            commandName: binItem,\n            config: {\n                version: pkg.version,\n                commandLine: {\n                    banner: `Gen-X entity modeling command line v${pkg.version}`,\n                    program: binItem,\n                    arguments: [\n                        {\n                            name: \"command\",\n                            required: true,\n                            inquire: true,\n                            promptType: \"list\",\n                            promptMessage: \"What command are you going to execute?\",\n                            choicesProvider: _.map(Commands, (desc, cmd) => ({ name: `${cmd} - ${desc}`, value: cmd })),\n                            afterInquire: afterCommandConfirmed,\n                            onArgumentExists: afterCommandConfirmed,\n                        },\n                    ],\n                    options: {\n                        s: {\n                            desc: \"Silent mode\",\n                            alias: [\"silent\"],\n                            bool: true,\n                            default: false,\n                        },\n                        v: {\n                            desc: \"Show version information\",\n                            alias: [\"version\"],\n                            bool: true,\n                            default: false,\n                        },\n                        verbose: {\n                            desc: \"Show verbose information\",\n                            bool: true,\n                            default: false,\n                            afterInquire: onVerboseMode,\n                            onArgumentExists: onVerboseMode,\n                        },\n                        h: {\n                            desc: \"Show usage message\",\n                            alias: [\"help\"],\n                            bool: true,\n                            default: false,\n                        },\n                        c: {\n                            desc: \"Config path\",\n                            alias: [\"conf\", \"config\"],\n                        },\n                        allow: {\n                            desc: \"Allow features\",\n                            alias: [\"allow-feature\"],\n                            type: 'list'\n                        },\n                        fp: {\n                            desc: \"Feature(s) path\",\n                            alias: [\"feature-path\", \"features-path\"]\n                        },\n                        mp: {\n                            desc: \"Model(s) path\",\n                            alias: [\"model-path\", \"models-path\"]\n                        }\n                    },\n                    silentMode: (cli) => cli.argv[\"silent\"] || cli.argv[\"version\"] || cli.argv[\"help\"],\n                    nonValidationMode: (cli) => cli.argv[\"version\"] || cli.argv[\"help\"],\n                    showUsageOnError: true,\n                    showArguments: (cli) => cli.argv[\"verbose\"],\n                },\n            },\n        }\n    );\n}\n\nif (!module.parent) {\n    main();\n} else {\n    module.exports = main;\n}\n"],"mappings":"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"}