{"version":3,"file":"ast.js","names":["_","require","escodegen","esprima","AST_OBJECT_TYPES","astParams","params","Array","isArray","map","p","astId","isPlainObject","type","oolType","defaultValue","name","astLiteral","Error","JSON","stringify","mapArgs","args","isEmpty","a","astValue","mapBody","body","astBlock","astProgram","strict","astExpression","astRequire","varName","requirePath","isObjDestruct","astObjPat","astCall","astLeadingComments","comment","length","astVarDeclare","left","right","isConstant","isNil","astClassDeclare","className","superClassName","ast","astMemberMethod","generator","async","isStatic","astAnonymousFunction","join","last","astIf","test","consequent","alternate","astBinExp","operator","astLogicalExp","functionName","astVarRef","astYield","target","delegate","astAwait","astArrayAccess","index","elementStyle","split","result","pop","astThis","keys","k","astMember","key","any","shorthand","startsWith","value","e","indexOf","literal","tokenize","regex","pattern","flags","props","forOwn","push","isObject","astAddMember","obj","member","properties","astPushInBody","expr","concat","castArray","astFunction","astArrowFunction","astMatchObject","idList","id","astAssign","astConditional","astThrow","astNot","astReturn","val","astToCode","generate","format","indent","style","base","adjustMultilineComment","newline","space","json","renumber","hexadecimal","quotes","escapeless","compact","parentheses","semicolons","safeConcatenation","module","exports"],"sources":["../../../src/modeler/util/ast.js"],"sourcesContent":["\"use strict\";\n\n/**\n * @module\n * @ignore\n */\n\nconst { _ } = require('@genx/july');\nconst escodegen = require('escodegen');\nconst esprima = require('esprima');\n\nconst AST_OBJECT_TYPES = [\n    'ThisExpression',\n    'MemberExpression',\n    'BinaryExpression',\n    'UnaryExpression',\n    'ArrowFunctionExpression',\n    'FunctionExpression',\n    'ArrayExpression',\n    'ObjectExpression',\n    'CallExpression',\n    'YieldExpression',\n    'AwaitExpression',\n    'AssignmentExpression',\n    'Literal',\n    'Identifier'\n];\n\nfunction astParams(params) {\n    params = Array.isArray(params) ? params : [ params ];\n\n    return params.map(p => {\n         if (typeof p === 'string') {\n             return astId(p);\n         }\n\n        if (_.isPlainObject(p)) {\n            if (p.type === 'Identifier' || p.type === 'AssignmentPattern') {\n                return p;\n            }\n\n            if (p.oolType === 'Parameter') {\n                if (p.defaultValue) {\n                    return {\n                        \"type\": \"AssignmentPattern\",\n                        \"left\": {\n                            \"type\": \"Identifier\",\n                            \"name\": p.name\n                        },\n                        \"right\": astLiteral(p.defaultValue)\n                    };\n                }\n\n                return astId(p.name);\n            }\n        }\n\n        throw new Error('Invalid param: ' + JSON.stringify(p));\n    });\n}\n\nfunction mapArgs(args) {\n    args = Array.isArray(args) ? args : [ args ];\n\n    if (_.isEmpty(args)) return [];\n\n    return args.map(a => {\n        if (_.isPlainObject(a) && 'type' in a) {\n            return a;\n        }\n\n        return astValue(a);\n    });\n}\n\nfunction mapBody(body) {\n    if (Array.isArray(body)) {\n        return astBlock(body);\n    }\n    \n    if (_.isPlainObject(body) && 'type' in body) {\n        return body;\n    }\n\n    return astValue(body);\n}\n\nfunction astProgram(strict = true) {\n    return {\n        \"type\": \"Program\",\n        \"body\": strict ? [astExpression(astValue('use strict'))] : [],\n        \"sourceType\": \"script\"\n    };\n}\n\nfunction astRequire(varName, requirePath, isObjDestruct = false) {\n    return {\n        \"type\": \"VariableDeclaration\",\n        \"declarations\": [\n            {\n                \"type\": \"VariableDeclarator\",\n                \"id\": isObjDestruct ? astObjPat(varName) : astId(varName),\n                \"init\": astCall('require', [ astValue(requirePath) ])\n            }\n        ],\n        \"kind\": \"const\"\n    };\n}\n\nfunction astLeadingComments(comment, type = 'Line') {\n    return comment ? { \"leadingComments\": [\n        {\n            \"type\": type,\n            \"value\": comment,\n            \"range\": [\n                1,\n                comment.length+3\n            ]\n        }\n    ]} : {};\n}\n\nfunction astVarDeclare(left, right, isConstant = false, isObjDestruct = false, comment = false) {\n    return {\n        \"type\": \"VariableDeclaration\",\n        \"declarations\": [\n            {\n                \"type\": \"VariableDeclarator\",\n                \"id\": isObjDestruct ? astObjPat(left) : astId(left),\n                \"init\": _.isNil(right) ? null : astValue(right)\n            }\n        ],\n        \"kind\": isConstant ? \"const\" : \"let\",\n        ...astLeadingComments(comment)\n    };\n}\n\nfunction astClassDeclare(className, superClassName, body, comment = false) {\n    let ast = {\n        \"type\": \"ClassDeclaration\",\n        \"id\": astId(className),\n        ...(comment ? astLeadingComments(`*\\n * ${comment}\\n * @class\\n `, 'Block') : {})\n    };\n\n    if (superClassName) {\n        ast['superClass'] = astId(superClassName);\n    }\n\n    ast['body'] = {\n        \"type\": \"ClassBody\",\n        \"body\": body ? (Array.isArray(body) ? body : [ body ]) : []\n    };\n\n    return ast;\n}\n\nfunction astMemberMethod(name, params, body, generator = false, async = false, isStatic = false, comment = false) {\n    return {\n        \"type\": \"MethodDefinition\",\n        \"key\": astId(name),\n        \"computed\": false,\n        \"value\": astAnonymousFunction(params, body, generator, async),\n        \"kind\": \"method\",\n        \"static\": isStatic,\n        //\"*\\n * \\n * @param identity\\n * @param password\\n * @returns {*}\\n \"\n        ...(comment ? astLeadingComments(`*\\n * ${comment}${params.map(p => `\\n * @param ${p}`).join('')}${Array.isArray(body) && _.last(body).type === 'ReturnStatement' ? '\\n * @returns {*}' : ''}\\n `, 'Block') : {})\n    };\n}\n\nfunction astIf(test, consequent, alternate, comment = false) {\n    return {\n        \"type\": \"IfStatement\",\n        \"test\": astValue(test),\n        \"consequent\": mapBody(consequent),\n        \"alternate\": _.isNil(alternate) ? null : mapBody(alternate),\n        ...astLeadingComments(comment)\n    };\n}\n\nfunction astBinExp(left, operator, right) {\n    return {\n        \"type\": \"BinaryExpression\",\n        \"operator\": operator,\n        \"left\": astValue(left),\n        \"right\": astValue(right)\n    }\n}\n\nfunction astLogicalExp(left, operator, right) {\n    return {\n        \"type\": \"LogicalExpression\",\n        \"operator\": operator,\n        \"left\": astValue(left),\n        \"right\": astValue(right)\n    }\n}\n\nfunction astCall(functionName, args) {\n    return {\n        \"type\": \"CallExpression\",\n        \"callee\": _.isPlainObject(functionName) ? functionName : astVarRef(functionName),\n        \"arguments\": mapArgs(args)\n    };\n}\n\nfunction astYield(target, delegate = false) {\n    return {\n        \"type\": \"YieldExpression\",\n        \"argument\": target,\n        \"delegate\": delegate\n    };\n}\n\nfunction astAwait(functionName, args) {\n    return {\n        \"type\": \"AwaitExpression\",\n        \"argument\": astCall(functionName, args)\n    };\n}\n\nfunction astArrayAccess(name, index) {\n    return {\n        \"type\": \"MemberExpression\",\n        \"computed\": true,\n        \"object\": astVarRef(name),\n        \"property\": {\n            \"type\": \"Literal\",\n            \"value\": index,\n            \"raw\": `${index}`\n        }\n    }\n}\n\nfunction astVarRef(name, elementStyle = false) {\n    if (_.isPlainObject(name)) {\n        if (name.type === 'MemberExpression' || name.type === 'Identifier') {\n            return name;\n        }\n\n        if (name.oolType === 'ObjectReference') {\n            return astVarRef(name.name, elementStyle);\n        }\n\n        throw new Error('Invalid reference: ' + JSON.stringify(name));\n    }\n\n    let p = name.split('.');\n    if (p.length > 1) {\n        //p.reverse();\n        let result = {\n            \"type\": \"MemberExpression\",\n            \"computed\": elementStyle,\n            \"property\": elementStyle ? astLiteral(p.pop()) : astId(p.pop())\n        };\n\n        let last = result;\n\n        while (p.length > 1) {\n            last[\"object\"] = {\n                \"type\": \"MemberExpression\",\n                \"computed\": elementStyle,\n                \"property\": elementStyle ? astLiteral(p.pop()) : astId(p.pop())\n            };\n\n            last = last[\"object\"];\n        }\n\n        last[\"object\"] = p[0] === 'this' \n            ? astThis()\n            : astId(p[0]);\n\n        return result;\n    } else {\n        return astId(name);\n    }\n}\n\nfunction astThis() {\n    return { \"type\": \"ThisExpression\" };\n}\n\nfunction astId(name) {\n    if (typeof name === 'string') {\n        return {\n            \"type\": \"Identifier\",\n            \"name\": name\n        };\n    } else if (_.isPlainObject(name) && name.type === 'Identifier') {\n        return name;\n    }\n\n    throw new Error('Invalid identifier name: ' + JSON.stringify(name));\n}\n\nfunction astObjPat(keys) {\n    return {\n        \"type\": \"ObjectPattern\",\n        \"properties\": _.map(keys, (k) => ({\n            \"type\": \"Property\",\n            \"key\": astId(k),\n            \"computed\": false,\n            \"value\": astId(k),\n            \"kind\": \"init\",\n            \"method\": false,\n            \"shorthand\": true\n        }))\n    };\n}\n\nfunction astMember(key, any, shorthand = false) {\n    return {\n        \"type\": \"Property\",\n        \"key\": key.startsWith(':') ? astLiteral(key) : astId(key),\n        \"computed\": false,\n        \"value\": any,\n        \"kind\": \"init\",\n        \"method\": false,\n        \"shorthand\": shorthand\n    };\n}\n\nfunction astValue(value) {\n    if (Array.isArray(value)) {\n        return {\n            \"type\": \"ArrayExpression\",\n            \"elements\": _.map(value, e => astValue(e))\n        };\n    }\n\n    if (_.isPlainObject(value)) {\n        if (AST_OBJECT_TYPES.indexOf(value.type) !== -1) {\n            return value;\n        }\n\n        if (value.oolType === 'ObjectReference') {\n            return astVarRef(value.name, true);\n        }\n\n        if (value.oolType === 'RegExp') {\n            let [ literal ] = esprima.tokenize(value.value);\n            return {\n                \"type\": \"NewExpression\",\n                \"callee\": {\n                    \"type\": \"Identifier\",\n                    \"name\": \"RegExp\"\n                },\n                \"arguments\": [\n                    astLiteral(literal.regex.pattern),\n                    ...(literal.regex.flags ? [ astLiteral(literal.regex.flags) ] : [])\n                ]\n            };\n        }\n\n        let props = [];\n\n        _.forOwn(value, (any, key) => {\n            props.push(astMember(key, astValue(any)));\n        });\n\n        return {\n            \"type\": \"ObjectExpression\",\n            \"properties\": props\n        };\n    }\n\n    if (_.isObject(value)) {\n        throw new Error('Only plain object supported. Given: ' + JSON.stringify(value));\n    }\n\n    return astLiteral(value);\n}\n\nfunction astLiteral(value) {\n    return {\n        \"type\": \"Literal\",\n        \"value\": value,\n        \"raw\": JSON.stringify(value)\n    };\n}\n\nfunction astAddMember(obj, member) {\n    obj.properties.push(member);\n}\n\nfunction astPushInBody(obj, expr) {\n    if (Array.isArray(obj.body)) {\n        obj.body = obj.body.concat(_.castArray(expr));\n    } else {\n        obj.body.body = obj.body.body.concat(_.castArray(expr));\n    }\n}\n\nfunction astFunction(name, params, body, generator = false, async = false) {\n    return {\n        \"type\": \"FunctionDeclaration\",\n        \"id\": astId(name),\n        \"generator\": generator,\n        \"expression\": false,\n        \"async\": async,\n        \"defaults\": [],\n        \"params\": astParams(params),\n        \"body\": astBlock(body)\n    };\n}\n\nfunction astAnonymousFunction(params, body, generator = false, async = false) {\n    return {\n        \"type\": \"FunctionExpression\",\n        \"id\": null,\n        \"params\": astParams(params),\n        \"defaults\": [],\n        \"body\": astBlock(body),\n        \"generator\": generator,\n        \"expression\": false,\n        \"async\": async\n    };\n}\n\nfunction astArrowFunction(params, body, generator = false, async = false) {\n    return {\n        \"type\": \"ArrowFunctionExpression\",\n        \"id\": null,\n        \"params\": astParams(params),\n        \"body\": mapBody(body),\n        \"generator\": generator,\n        \"expression\": true,\n        \"async\": async\n    }\n}\n\nfunction astBlock(body) {\n    return {\n        \"type\": \"BlockStatement\",\n        \"body\": Array.isArray(body) ? body : [ body ]\n    };\n}\n\nfunction astMatchObject(idList, right, isConstant = true) {\n    return {\n        \"type\": \"VariableDeclaration\",\n        \"declarations\": [\n            {\n                \"type\": \"VariableDeclarator\",\n                \"id\": {\n                    \"type\": \"ObjectPattern\",\n                    \"properties\": _.map(idList, id => astMember(id, astId(id), true))\n                },\n                \"init\": right\n            }\n        ],\n        \"kind\": isConstant ? \"const\" : \"let\"\n    };\n}\n\nfunction astExpression(expr, comment = false) {\n    return {\n        \"type\": \"ExpressionStatement\",\n        \"expression\": expr,\n        ...astLeadingComments(comment)\n    };\n}\n\nfunction astAssign(left, right, comment = false) {\n    return astExpression({\n        \"type\": \"AssignmentExpression\",\n        \"operator\": \"=\",\n        \"left\": astVarRef(left),\n        \"right\": astValue(right)\n    }, comment);\n}\n\nfunction astConditional(test, consequent, alternate) {\n    return {\n        \"type\": \"ConditionalExpression\",\n        \"test\": astValue(test),\n        \"consequent\": astValue(consequent),\n        \"alternate\": astValue(alternate)\n    }\n}\n\nfunction astThrow(name, args) {\n    return {\n        \"type\": \"ThrowStatement\",\n        \"argument\": {\n            \"type\": \"NewExpression\",\n            \"callee\": astVarRef(name),\n            \"arguments\": mapArgs(args)\n        }\n    };\n}\n\nfunction astNot(expr) {\n    return {\n        \"type\": \"UnaryExpression\",\n        \"operator\": \"!\",\n        \"argument\": astValue(expr),\n        \"prefix\": true\n    };\n}\n\nfunction astReturn(val) {\n    return {\n        \"type\": \"ReturnStatement\",\n        \"argument\": astValue(val)\n    };\n}\n\nfunction astToCode(ast) {       \n    return escodegen.generate(ast, {\n        format: {\n            indent: {\n                style: '    ',\n                base: 0,\n                adjustMultilineComment: false\n            },\n            newline: '\\n',\n            space: ' ',\n            json: false,\n            renumber: false,\n            hexadecimal: false,\n            quotes: 'single',\n            escapeless: false,\n            compact: false,\n            parentheses: true,\n            semicolons: true,\n            safeConcatenation: false\n        },\n        comment: true\n    });\n}\n\nmodule.exports = {\n    astProgram,\n    astRequire,\n    astVarDeclare,\n    astClassDeclare,\n    astMemberMethod,\n    astCall,\n    astYield,\n    astAwait,\n    astThis,\n    astId,\n    astVarRef,\n    astValue,\n    astFunction,\n    astAnonymousFunction,\n    astArrowFunction,\n    astIf,\n    astConditional,\n    astBinExp,\n    astLogicalExp,\n    astBlock,\n    astMatchObject,\n    astExpression,\n    astAssign,\n    astAddMember,\n    astMember,\n    astPushInBody,\n    astThrow,\n    astNot,\n    astReturn,\n    astLiteral,\n    astParams,\n    astArrayAccess,\n    astToCode\n};"],"mappings":"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"}