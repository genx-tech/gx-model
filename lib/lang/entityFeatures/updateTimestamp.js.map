{"version":3,"sources":["../../../src/lang/entityFeatures/updateTimestamp.js"],"names":["FEATURE_NAME","initialize","entity","args","typeInfo","name","type","readOnly","forceUpdate","optional","options","Object","assign","fieldName","addFeature","field","once","addField","module","exports"],"mappings":"AAAA;;;;AAEA,MAAMA,YAAY,GAAG,iBAArB;;AAYA,SAASC,UAAT,CAAoBC,MAApB,EAA4BC,IAAI,GAAG,EAAnC,EAAuC;AACnC,MAAIC,QAAQ,GAAG;AACXC,IAAAA,IAAI,EAAE,WADK;AAEXC,IAAAA,IAAI,EAAE,UAFK;AAGXC,IAAAA,QAAQ,EAAE,IAHC;AAIXC,IAAAA,WAAW,EAAE,IAJF;AAKXC,IAAAA,QAAQ,EAAE;AALC,GAAf;AAQA,MAAI,CAAEC,OAAF,IAAcP,IAAlB;;AAEA,MAAIO,OAAJ,EAAa;AACT,QAAI,OAAOA,OAAP,KAAmB,QAAvB,EAAiC;AAC7BA,MAAAA,OAAO,GAAG;AAAEL,QAAAA,IAAI,EAAEK;AAAR,OAAV;AACH;;AAEDC,IAAAA,MAAM,CAACC,MAAP,CAAcR,QAAd,EAAwBM,OAAxB;AACH;;AAED,MAAIG,SAAS,GAAGT,QAAQ,CAACC,IAAzB;AAEAH,EAAAA,MAAM,CAACY,UAAP,CAAkBd,YAAlB,EAAgC;AAC5Be,IAAAA,KAAK,EAAEF;AADqB,GAAhC,EAEGG,IAFH,CAEQ,mBAFR,EAE6B,MAAM;AAC/Bd,IAAAA,MAAM,CAACe,QAAP,CAAgBJ,SAAhB,EAA2BT,QAA3B;AACH,GAJD;AAKH;;AAEDc,MAAM,CAACC,OAAP,GAAiBlB,UAAjB","sourcesContent":["\"use strict\";\n\nconst FEATURE_NAME = 'updateTimestamp';\n\n/**\n * A rule specifies the change of state will be tracked automatically.\n * @module EntityFeature_UpdateTimestamp\n */\n\n/**\n * Initialize the feature\n * @param {OolongEntity} entity - Entity to apply this feature\n * @param {object} options - Field options\n */\nfunction initialize(entity, args = []) {\n    let typeInfo = {\n        name: 'updatedAt',\n        type: 'datetime',\n        readOnly: true,\n        forceUpdate: true,\n        optional: true\n    };\n\n    let [ options ] = args;\n\n    if (options) {\n        if (typeof options === 'string') {\n            options = { name: options };\n        }\n\n        Object.assign(typeInfo, options);\n    }\n\n    let fieldName = typeInfo.name;\n\n    entity.addFeature(FEATURE_NAME, {\n        field: fieldName\n    }).once('afterAddingFields', () => {\n        entity.addField(fieldName, typeInfo)\n    });\n}\n\nmodule.exports = initialize;"],"file":"updateTimestamp.js"}