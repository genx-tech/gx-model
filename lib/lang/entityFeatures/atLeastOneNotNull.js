"use strict";

require("source-map-support/register");

const FEATURE_NAME = 'atLeastOneNotNull';

function feature(entity, [fields]) {
  if (!fields) {
    throw new Error('Missing field names!');
  }

  Array.isArray(fields) || (fields = [fields]);
  entity.addFeature(FEATURE_NAME, fields, true).once('afterAddingFields', () => {
    fields.forEach(fieldName => {
      let field = entity.fields[fieldName];

      if (!field) {
        throw new Error('Required field "' + fieldName + '" not exist.');
      }

      field.optional = true;
    });
  });
}

module.exports = feature;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9sYW5nL2VudGl0eUZlYXR1cmVzL2F0TGVhc3RPbmVOb3ROdWxsLmpzIl0sIm5hbWVzIjpbIkZFQVRVUkVfTkFNRSIsImZlYXR1cmUiLCJlbnRpdHkiLCJmaWVsZHMiLCJFcnJvciIsIkFycmF5IiwiaXNBcnJheSIsImFkZEZlYXR1cmUiLCJvbmNlIiwiZm9yRWFjaCIsImZpZWxkTmFtZSIsImZpZWxkIiwib3B0aW9uYWwiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQTs7OztBQUVBLE1BQU1BLFlBQVksR0FBRyxtQkFBckI7O0FBWUEsU0FBU0MsT0FBVCxDQUFpQkMsTUFBakIsRUFBeUIsQ0FBRUMsTUFBRixDQUF6QixFQUFxQztBQUNqQyxNQUFJLENBQUNBLE1BQUwsRUFBYTtBQUNULFVBQU0sSUFBSUMsS0FBSixDQUFVLHNCQUFWLENBQU47QUFDSDs7QUFFREMsRUFBQUEsS0FBSyxDQUFDQyxPQUFOLENBQWNILE1BQWQsTUFBMEJBLE1BQU0sR0FBRyxDQUFFQSxNQUFGLENBQW5DO0FBRUFELEVBQUFBLE1BQU0sQ0FBQ0ssVUFBUCxDQUFrQlAsWUFBbEIsRUFBZ0NHLE1BQWhDLEVBQXdDLElBQXhDLEVBQThDSyxJQUE5QyxDQUFtRCxtQkFBbkQsRUFBd0UsTUFBTTtBQUMxRUwsSUFBQUEsTUFBTSxDQUFDTSxPQUFQLENBQWVDLFNBQVMsSUFBSTtBQUN4QixVQUFJQyxLQUFLLEdBQUdULE1BQU0sQ0FBQ0MsTUFBUCxDQUFjTyxTQUFkLENBQVo7O0FBRUEsVUFBSSxDQUFDQyxLQUFMLEVBQVk7QUFDUixjQUFNLElBQUlQLEtBQUosQ0FBVSxxQkFBcUJNLFNBQXJCLEdBQWlDLGNBQTNDLENBQU47QUFDSDs7QUFFREMsTUFBQUEsS0FBSyxDQUFDQyxRQUFOLEdBQWlCLElBQWpCO0FBQ0gsS0FSRDtBQVNILEdBVkQ7QUFXSDs7QUFFREMsTUFBTSxDQUFDQyxPQUFQLEdBQWlCYixPQUFqQiIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5jb25zdCBGRUFUVVJFX05BTUUgPSAnYXRMZWFzdE9uZU5vdE51bGwnO1xuXG4vKipcbiAqIEEgcnVsZSBzcGVjaWZpZXMgYXQgbGVhc3Qgb25lIGZpZWxkIG5vdCBudWxsLCBlLmcuIGVtYWlsIG9yIG1vYmlsZS5cbiAqIEBtb2R1bGUgRW50aXR5RmVhdHVyZV9BdExlYXN0T25lTm90TnVsbFxuICovXG5cbi8qKlxuICogSW5pdGlhbGl6ZSB0aGUgZmVhdHVyZVxuICogQHBhcmFtIHtPb2xvbmdFbnRpdHl9IGVudGl0eSAtIEVudGl0eSB0byBhcHBseSB0aGlzIGZlYXR1cmVcbiAqIEBwYXJhbSB7YXJyYXl9IGZpZWxkcyAtIExpc3Qgb2YgZmllbGQgbmFtZXNcbiAqL1xuZnVuY3Rpb24gZmVhdHVyZShlbnRpdHksIFsgZmllbGRzIF0pIHtcbiAgICBpZiAoIWZpZWxkcykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgZmllbGQgbmFtZXMhJyk7XG4gICAgfVxuXG4gICAgQXJyYXkuaXNBcnJheShmaWVsZHMpIHx8IChmaWVsZHMgPSBbIGZpZWxkcyBdKTtcblxuICAgIGVudGl0eS5hZGRGZWF0dXJlKEZFQVRVUkVfTkFNRSwgZmllbGRzLCB0cnVlKS5vbmNlKCdhZnRlckFkZGluZ0ZpZWxkcycsICgpID0+IHtcbiAgICAgICAgZmllbGRzLmZvckVhY2goZmllbGROYW1lID0+IHtcbiAgICAgICAgICAgIGxldCBmaWVsZCA9IGVudGl0eS5maWVsZHNbZmllbGROYW1lXTtcblxuICAgICAgICAgICAgaWYgKCFmaWVsZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignUmVxdWlyZWQgZmllbGQgXCInICsgZmllbGROYW1lICsgJ1wiIG5vdCBleGlzdC4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZmllbGQub3B0aW9uYWwgPSB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBmZWF0dXJlOyJdfQ==